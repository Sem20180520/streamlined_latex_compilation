\chapter{一次函数}%第8章

\begin{mysimplebox}{問1}
    一次函数$\frac{az+b}{cz+d}$（$a,b,c,d\in\C,ad-bc\neq0$）
    は3つの一次函数
    $z+h$（$h\neq0$）、
    $\alpha z$（$\alpha\neq0$）、
    $\frac{1}{z}$
    を合成したものと考えられることを示せ。
\end{mysimplebox}
\paragraph{解答}
平行移動、定数倍、逆数をとる、再び平行移動の順に合成すると、
\begin{align*}
    z
    \mapsto z+h
    \mapsto \alpha(z+h)=\alpha z+\alpha h
    \mapsto \frac{1}{\alpha z+\alpha h}
    \mapsto \frac{1}{\alpha z+\alpha h}+h'
    =\frac{\alpha h'z+\alpha hh'+1}{\alpha z+\alpha h}
\end{align*}
となる。行列で表すと、
\begin{align*}
    \begin{bmatrix}
        1&h'\\
        0&1
    \end{bmatrix}
    \begin{bmatrix}
        0&1\\
        1&0
    \end{bmatrix}
    \begin{bmatrix}
        \alpha&0\\
        0&1
    \end{bmatrix}
    \begin{bmatrix}
        1&h\\
        0&1
    \end{bmatrix}
    =\begin{bmatrix}
        \alpha h'&\alpha hh'+1\\
        \alpha&\alpha h
    \end{bmatrix}
\end{align*}
である。この左辺の行列がすべて正則であるから、右辺の行列も正則である。

$c=0$のとき、ある$k\in\C,k\neq0$によって、
\begin{align*}
    a&=k\alpha h'\\
    b&=k(\alpha hh'+1)\\
    c&=k\alpha\\
    d&=k\alpha h
\end{align*}
と書けることを示せばよい。

$h=d/c$、$h'=a/c$がすぐにわかる。

また、$b=\frac{ad}{c}+k$であるから、
\begin{align*}
    k=b-\frac{ad}{c}=-\frac{ad-bc}{c}
\end{align*}
である。
よって、$\alpha=c/k=-(ad-bc)^{-1}$とすればよい。

次に、$c=0$のとき、$\frac{az+b}{cz+d}=(a/d)z+(b/d)$であるから、
\begin{align*}
    z\mapsto \frac{a}{d}z\mapsto \frac{a}{d}z+\frac{b}{d}
\end{align*}
とすればよい。（終）
\paragraph{補足}
$c\neq0$のとき、
\begin{align*}
    \frac{az+b}{cz+d}
    =\frac{\frac{a}{c}z+\frac{b}{c}}{z+\frac{d}{c}}
    =\frac{\frac{a}{c}\left(z+\frac{d}{c}\right)-\frac{ad}{c^2}+\frac{b}{c}}{z+\frac{d}{c}}
    =\frac{a}{c}-\frac{ad-bc}{c^2}\cdot\frac{1}{z+\frac{d}{c}}
\end{align*}
であるから、$\frac{d}{c}$だけ平行移動する、逆数をとる、$-\frac{ad-bc}{c^2}$倍する、$\frac{a}{c}$だけ平行移動する、という操作で$\frac{az+b}{cz+d}$という一次函数が得られる。

$c=0$のとき、
\begin{align*}
    \frac{az+b}{d}
    =\frac{a}{d}z+\frac{b}{d}
\end{align*}
であるから、$\frac{a}{d}$倍する、$\frac{b}{d}$だけ平行移動する、という操作で$\frac{az+b}{d}$という一次函数が得られる。または、$a$倍する、$b$だけ平行移動する、$\frac{1}{d}$倍する、という操作でもよい。これは、
\begin{align*}
    \begin{bmatrix}
        1&b/d\\0&1
    \end{bmatrix}
    \begin{bmatrix}
        a/d&0\\0&1
    \end{bmatrix}
    =
    \begin{bmatrix}
        1/d&0\\0&1
    \end{bmatrix}
    \begin{bmatrix}
        1&b\\0&1
    \end{bmatrix}
    \begin{bmatrix}
        a&0\\0&1
    \end{bmatrix}
    =
    \begin{bmatrix}
        a/d&b/d\\0&1
    \end{bmatrix}
\end{align*}
という行列計算が対応する。


\newpage
\begin{mysimplebox}{問2}
    一次函数は円（または直線）に関し偶数回反転することによってできたものと考えられることを示せ。
\end{mysimplebox}
\paragraph{解答}
書籍p.155で説明されているように、点$c$を中心とする半径$r$の円に関する反転は、
\begin{align*}
    z'=c+\frac{r^2}{\overline{z}-\overline{c}}
\end{align*}
と書ける。ここで、$z,z'$は互いの反転である。

この式は、
\begin{align*}
    z'=\frac{c\overline{z}-|c|^2+r^2}{\overline{z}-\overline{c}}
    =\overline{\left(\frac{\overline{c}z-|c|^2+r^2}{z-c}\right)}
\end{align*}
と書ける。

さらに、点$c'$を中心とする半径$r'$の円に関する反転を続けて行うと、
\begin{align*}
    z''=\overline{\left(\frac{\overline{c'}z'-|c'|^2+r'^2}{z'-c'}\right)}
    =\frac{c'\overline{z'}-|c'|^2+r'^2}{\overline{z'}-\overline{c'}}
\end{align*}
である。これは、
\begin{align*}
    \begin{bmatrix}
        c'&-|c'|^2+r'^2\\
        1&-\overline{c'}
    \end{bmatrix}
    \begin{bmatrix}
        \overline{c}&-|c|^2+r^2\\
        1&-c
    \end{bmatrix}
\end{align*}
に対応する一次函数である。
実際、この行列の行列式は、
\begin{align*}
    (-|c'|^2+|c'|^2-r'^2)(-|c|^2+|c|^2-r^2)=r^2r'^2\neq0
\end{align*}
である。（終）

\newpage
\begin{mysimplebox}{問3}
    半平面$\Im(z)>0$を$|w|<1$に写像する一次函数は
    \begin{align*}
        w=\frac{az+b}{\overline{a}z+\overline{b}}
        \quad\left(\Im\left(\frac{b}{a}\right)<0\right)
    \end{align*}
    であることを示せ。
\end{mysimplebox}
\paragraph{証明}
\begin{align*}
    f(z)=\frac{az+b}{\overline{a}z+\overline{b}}
\end{align*}
とする。円円対応により、$f$は実軸を円または直線に写像する。
$x\in\R$とすると、
\begin{align*}
    \left|f(x)\right|
    =\left|\frac{ax+b}{\overline{a}x+\overline{b}}\right|
    =\left|\frac{ax+b}{\overline{(ax+b)}}\right|
    =1
\end{align*}
であるから、$f$は実軸を単位円に写像することがわかる。

条件から、$\Im\left(-\frac{b}{a}\right)>0$、
すなわち、$-\frac{b}{a}$は上半平面の点であるが、
\begin{align*}
    f\left(-\frac{b}{a}\right)
    =\frac{-a\frac{b}{a}+b}{-\overline{a}\frac{b}{a}+\overline{b}}
    =\frac{0}{-\overline{a}b+a\overline{b}}
    =0
\end{align*}
であるから、$f$は上半平面を単位円内に写像する。（証明終）

\newpage
\begin{mysimplebox}{問4}
    一次函数
    \begin{align*}
        f(z)=\frac{az+b}{cz+d}
        \quad\left(a,b,c,d\in\R,ad-bc>0\right)
    \end{align*}
    は半平面$\Im(z)>0$を半平面$\Im(w)>0$に写像することを示せ。
\end{mysimplebox}
\paragraph{証明}
$a\neq0,c\neq0$のとき、
\begin{align*}
    f(z)=&\frac{a}{c}\cdot\frac{cz+\frac{bc}{a}}{cz+d}
    =\frac{a}{c}\cdot\frac{cz+d-d+\frac{bc}{a}}{cz+d}
    =\frac{a}{c}\left(1-\frac{1}{a}\cdot\frac{ad-bc}{cz+d}\right)
\end{align*}
と書けるから、$f$は実軸を実軸に写像する。
\footnote{わざわざこの式変形をしなくても$f$が実軸を実軸に写像することは分かる。}

$a=0,c\neq0$のとき、
\begin{align*}
    f(z)=\frac{b}{cz+d}
\end{align*}
であるから、やはり$f$は実軸を実軸に写像する。

$a\neq0,c=0$ならば、
\begin{align*}
    f(z)=\frac{az+b}{d}
\end{align*}
であるから、やはり$f$は実軸を実軸に写像する。

\begin{align*}
    f(i)&=\frac{ai+b}{ci+d}
    =\frac{(ai+b)(-ci+d)}{(ci+d)(-ci+d)}
    =\frac{ac+bd+(ad-bc)i}{c^2+d^2}
\end{align*}
であり、$ad-bc>0$であるから、$\Im f(i)>0$である。
よって、$f$は半平面$\Im(z)>0$を半平面$\Im(w)>0$に写像する。（証明終）

\newpage
\begin{mysimplebox}{問5}
    $z=f(z)$なる$z$を函数$f(z)$の不動点という。
    2個より多くの不動点をもつ一次函数は$z$以外にはないことを示せ。
\end{mysimplebox}
\paragraph{証明}
\begin{align*}
    f(z)=\frac{az+b}{cz+d}
\end{align*}
とする。ただし、$ad-bc\neq0$である。

$f(z)=z$から、
\begin{align}
    z&=\frac{az+b}{cz+d}\nonumber\\
    cz^2+dz&=az+b\nonumber\\
    cz^2+(d-a)z-b&=0\label{eq:ch8-4-1}
\end{align}
である。
\begin{itemize}
    \item $c\neq0$ならば、方程式$(\ref{eq:ch8-4-1})$は、重複度も込めて2個の解をもつ。
    \item $c=0,d-a\neq0$ならば、方程式$(\ref{eq:ch8-4-1})$は、1個の解をもつ。このとき、$f(z)=(az+b)/d$である。不動点は$b/(d-a)$である。$\infty$も不動点であると考える。
    \item $c=0,d-a=0,b\neq0$ならば、方程式$(\ref{eq:ch8-4-1})$は、解をもたない。このとき、$f(z)=z+b/a$である。$\infty$が不動点であると考える。
    \item $c=0,d-a=0,b=0$ならば、方程式$(\ref{eq:ch8-4-1})$は、$\C$全体が解である。このとき、$f(z)\equiv z$である。
\end{itemize}
以上から、不動点を2個より多くもつ一次函数は$f(z)\equiv z$のみである。（証明終）

\newpage
\begin{mysimplebox}{問6}
    $w=\dfrac{az+b}{cz+d}$
    は$\dfrac{w-\alpha}{w-\beta}=k\dfrac{z-\alpha}{z-\beta}$
    または
    $\dfrac{1}{w-\alpha}=\dfrac{1}{z-\alpha}+h$
    なる形に書き直すことができることを示せ。
    ただし、$\alpha,\beta,k,h$は定数である。
\end{mysimplebox}
\paragraph{証明}
\begin{align*}
    \begin{vmatrix}
        a&b\\
        c&d
    \end{vmatrix}
    =ad-bc=1
\end{align*}
としてよい。

前問の場合分けで順に見ていく。

$c\neq0$で、方程式$(\ref{eq:ch8-4-1})$が重根をもたないとき、
判別式$D$とすると、
\begin{align*}
    D=(d-a)^2+4bc
    =(d-a)^2+4(ad-1)
    =(a+d)^2-4\neq0
\end{align*}
である。

方程式$(\ref{eq:ch8-4-1})$の異なる2個の解を、$\alpha,\beta$とする。
\begin{align*}
    \alpha+\beta=&\frac{a-d}{c}\\
    \alpha\beta=&-\frac{b}{c}
\end{align*}
が成り立つ。

$\dfrac{z-\alpha}{z-\beta}$と$\dfrac{w-\alpha}{w-\beta}$の関係を考える。これは、次のような行列計算を見ればよい。
\begin{align*}
    \begin{bmatrix}
        1&-\alpha\\
        1&-\beta
    \end{bmatrix}
    \begin{bmatrix}
        a&b\\
        c&d
    \end{bmatrix}
    \begin{bmatrix}
        1&-\alpha\\
        1&-\beta
    \end{bmatrix}^{-1}
\end{align*}
計算を行うと、次の行列が得られる。
\begin{align*}
    \frac{1}{\alpha-\beta}
    \begin{bmatrix}
        d\alpha-a\beta-2b&0\\
        0&a\alpha-d\beta+2b
    \end{bmatrix}
\end{align*}
なお、
\begin{align*}
    \begin{vmatrix}
        1&-\alpha\\
        1&-\beta
    \end{vmatrix}
    =\alpha-\beta\neq0
\end{align*}
である。

以上で、
\begin{align*}
    \frac{w-\alpha}{w-\beta}
    =k\frac{z-\alpha}{z-\beta},\quad
    k=\frac{d\alpha-a\beta-2b}{a\alpha-d\beta+2b}
\end{align*}
であることが分かる。
\footnote{$k$は行列の固有値の比であることも分かった。}

次に、$D=(a+d)^2-4=0$のとき、重根を$\alpha=\dfrac{a-d}{2c}$とする。$\dfrac{1}{z-\alpha}$と$\dfrac{1}{w-\alpha}$の関係を考える。これは、次のような行列計算を見ればよい。
\begin{align*}
    \begin{bmatrix}
        0&1\\
        1&-\alpha
    \end{bmatrix}
    \begin{bmatrix}
        a&b\\
        c&d
    \end{bmatrix}
    \begin{bmatrix}
        0&1\\
        1&-\alpha
    \end{bmatrix}^{-1}
\end{align*}
計算を行うと、次の行列が得られる。
\begin{align*}
    \begin{bmatrix}
        (a+d)/2&c\\
        0&(a+d)/2
    \end{bmatrix}
\end{align*}
よって、
\begin{align*}
    \frac{1}{w-\alpha}
    =\frac{\{(a+d)/2\}\frac{1}{z-\alpha}+c}{\{(a+d)/2\}}
    =\frac{1}{z-\alpha}+\frac{2c}{a+d}
\end{align*}
であることが分かる。

不動点が$\alpha:=\dfrac{b}{d-a}$と$\infty$のとき（$d-a\neq0,c=0$）、
\begin{align*}
    w-\alpha
    =\frac{az+b}{d}-\frac{b}{d-a}
    =\frac{(az+b)(d-a)-bd}{d(d-a)}
    =\frac{a(d-a)z-ab}{d(d-a)}
    =\frac{a}{d}(z-\alpha)
\end{align*}
となり、$\dfrac{w-\alpha}{w-\beta}=k\dfrac{z-\alpha}{z-\beta}$の亜種と思うことができる（追記参照）。

不動点が$\infty$のみの場合、$w=f(z)=z+h$（$h\neq0$）
と書ける。$z=\dfrac{1}{\zeta}$、$w=\dfrac{1}{\xi}$とすると、$\dfrac{1}{\xi}=\dfrac{1}{\zeta}+h$であるから、
$\dfrac{1}{w-\alpha}=\dfrac{1}{z-\alpha}+h$の
$\alpha=0,h\neq0$の場合と思うことができる。

$f(z)=\dfrac{az+b}{cz+d}$
の不動点が2個より多いとき、$w=f(z)\equiv z$である。
これは
$\dfrac{1}{w-\alpha}=\dfrac{1}{z-\alpha}+h$
で$\alpha=0,h=0$の場合である。（証明終）

\paragraph{追記}
亜種と書いたタイプについては、その下のタイプと同様に$z=\dfrac{1}{\zeta}$、$w=\dfrac{1}{\xi}$としてみると、
\begin{align*}
    \xi
    =\frac{1}{w}
    =\frac{d}{az+b}
    =\frac{d/z}{a+b/z}
    =\frac{d\zeta}{b\zeta+a}
\end{align*}
であり、$\zeta=\dfrac{1}{\alpha},0$が不動点である。$\alpha=0$のときの扱いが面倒である。

その代わり、$z$のみ$z=\dfrac{1}{\zeta}$と変換し、$w$は$w$のままとすると、
\begin{align*}
    w=\frac{az+b}{d}=\frac{a+b/z}{d/z}=\frac{b\zeta+a}{d\zeta}
\end{align*}
である。不動点は、$\dfrac{b\zeta+a}{d\zeta}=\zeta$より、
$d\zeta^2-b\zeta-a=0$の解である。この判別式は$D=b^2+4ac=b^2+4\ge4$であるから、異なる2個の不動点を持つことが分かる。よって、不動点を$\alpha,\beta$とすると、$\dfrac{w-\alpha}{w-\beta}=k\dfrac{\zeta-\alpha}{\zeta-\beta}$の形にできる。次の行列計算をすればよい。
\begin{align*}
    \begin{bmatrix}
        1&-\alpha\\1&-\beta
    \end{bmatrix}
    \begin{bmatrix}
        a&b\\0&d
    \end{bmatrix}
    \begin{bmatrix}
        0&1\\1&0
    \end{bmatrix}^{-1}
    \begin{bmatrix}
        1&-\alpha\\1&-\beta
    \end{bmatrix}^{-1}
    =\frac{1}{\alpha-\beta}
    \begin{bmatrix}
        -2a-\beta b&0\\0&2a+\alpha b
    \end{bmatrix}
\end{align*}
これにより、$k=\dfrac{-2a-\beta b}{2a+\alpha b}$も分かる。
片方だけ逆数にすると不動点が変わるため、有限の異なる2個の不動点の場合に帰着できるという話である。$w$を$w=\dfrac{1}{\xi}$とし、$z$は$z$のままとしても同様の結果が得られる。